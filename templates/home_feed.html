{% extends "base.html" %} <!-- dsw -->
{% block content %} <!-- dsw -->
<h1>Django Image Uploading</h1>

<ul>
  {% for post in object_list %}
    <a href="/photo/{{post.id}}/"><img src="{{ post.image_file.url }}" alt="{{ post.caption }}" width='500' height="px"></a> <!-- dsw -->
    <p>{{post.caption}}{{post.id}}</p>

  <!-- ana -->
    {% if request.user.is_authenticated %}
      <form method="post">
        {% csrf_token %}

        {% if not request.user in post.liked.all %}
          <button name="redirect_url" value="{{request.path}}" formaction="/like/{{post.id}}/">Like</button>
        {% else %}
          <button name="redirect_url" value="{{request.path}}" formaction="/unlike/{{post.id}}/">Unlike</button>
        {% endif %}

        {% if request.user.username == post.author.username%}
          <button name="redirect_url" value="{{request.path}}" formaction="/deletepost/{{post.id}}/">Delete post</button>
        {% endif %}
      </form>

      {% if post.liked.count == 1 %}
        <div> {{post.liked.count}} like</div>
      {% else %}
        <div> {{post.liked.count}} likes</div>
      {% endif %}

    {% endif %}
  <!-- ana -->
  
  {% endfor %}
</ul>
{% endblock content %} <!-- dsw -->
